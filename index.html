<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TPL Marari - Reserva de Carrinhos e Display</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <header class="header">
        <img src="logo.svg" alt="Logo TPL" class="logo-img" />
        <h1>TPL Marari - Reserva de Carrinhos e Display</h1>
        <button id="darkModeToggle">
            <span class="icon">🌙</span>
            <span class="label">Modo escuro</span>
        </button>
    </header>

    <div class="main-container">
        <div class="calendar-checkboxes">
            <label class="calendar-checkbox">
                <input type="radio" name="calendar" value="1" onclick="toggleCalendar(1)">
                <span class="checkmark"></span>
                <strong>Ponto 1</strong> - Padaria Jd das Oliveiras
            </label>
            <label class="calendar-checkbox">
                <input type="radio" name="calendar" value="2" onclick="toggleCalendar(2)">
                <span class="checkmark"></span>
                <strong>Ponto 2</strong> - Mercado P&B | Ponto 5131
            </label>
            <label class="calendar-checkbox">
                <input type="radio" name="calendar" value="3" onclick="toggleCalendar(3)">
                <span class="checkmark"></span>
                <strong>Ponto 3</strong> - Praça Casa Palma
            </label>
            <label class="calendar-checkbox">
                <input type="radio" name="calendar" value="4" onclick="toggleCalendar(4)">
                <span class="checkmark"></span>
                <strong>Ponto 4</strong> - Padaria Primicia
            </label>
            <label class="calendar-checkbox">
                <input type="radio" name="calendar" value="5" onclick="toggleCalendar(5)">
                <span class="checkmark"></span>
                <strong>Ponto 5</strong> - Viaduto Washington Luiz
            </label>
        </div>

        <div class="calendar-container">
            <iframe id="calendarIframe" src=""></iframe>
        </div>
    </div>

    <script>
        const selectedCalendars = JSON.parse(localStorage.getItem("selectedCalendars")) || [];

        const calendarSrcMap = {
            1: "af1c95f4ae2831bba53c1cc769e785aefeb836b86a6af22aee8b1d2b73e6e190%40group.calendar.google.com",
            2: "e34e0be9c80ce654dc03c852e6e3c52af2f53d129295e297861523cbbeff93c2%40group.calendar.google.com",
            3: "d6c38e409070037546660123a107f4b95f65681a96c216cac7903d58465f5530%40group.calendar.google.com",
            4: "e22e471e522d36c6e1bca2edfcecfbc5ea23c9af8b5b4d10004bf2c7e4b2261f%40group.calendar.google.com",
            5: "1aa2749c04ae9ac703fa3b2ebbee2db79105711fcda01f98b82da998bc7488ce%40group.calendar.google.com"
        };

        function updateIframe() {
            const iframe = document.getElementById("calendarIframe");
            let src = "https://calendar.google.com/calendar/embed?";
            src += "ctz=America%2FSao_Paulo";
            src += "&mode=AGENDA"; // Visualização em lista

            selectedCalendars.forEach(calendar => {
                src += "&src=" + calendar;
            });

            iframe.src = src;
        }

        function toggleCalendar(calendarId) {
            const src = calendarSrcMap[calendarId];
            selectedCalendars.length = 0;
            selectedCalendars.push(src);
            localStorage.setItem("selectedCalendars", JSON.stringify(selectedCalendars));
            updateIframe();
        }

        window.addEventListener("load", () => {
            // Marcar o radio salvo
            Object.keys(calendarSrcMap).forEach(id => {
                const input = document.querySelector(`input[value="${id}"]`);
                if (selectedCalendars.includes(calendarSrcMap[id])) {
                    input.checked = true;
                }
            });
            updateIframe();
        });

        // Dark mode toggle
        const toggleButton = document.getElementById("darkModeToggle");
        const darkMode = localStorage.getItem("darkMode") === "true";

        function applyDarkMode(active) {
            document.body.classList.toggle("dark-mode", active);
            toggleButton.querySelector(".icon").textContent = active ? "☀️" : "🌙";
            toggleButton.querySelector(".label").textContent = active ? "Modo claro" : "Modo escuro";
        }

        toggleButton.addEventListener("click", () => {
            const enabled = document.body.classList.toggle("dark-mode");
            localStorage.setItem("darkMode", enabled);
            applyDarkMode(enabled);
        });

        applyDarkMode(darkMode);
    </script>
</body>
</html>
